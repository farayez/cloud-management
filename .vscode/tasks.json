{
  // See https://go.microsoft.com/fwlink/?LinkId=733558
  // for the documentation about the tasks.json format
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Initialize Service",
      "type": "shell",
      "command": "npm",
      "args": ["run", "service:init"],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Push Image",
      "type": "shell",
      "command": "npm",
      "args": ["run", "image:push", "${input:image}"],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Start Service",
      "type": "shell",
      "command": "npm",
      "args": ["run", "ecs:start_service", "${input:service}"],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Stop Service",
      "type": "shell",
      "command": "npm",
      "args": ["run", "ecs:stop_service", "${input:service}"],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Redeploy Service",
      "type": "shell",
      "command": "npm",
      "args": ["run", "ecs:redeploy_service", "${input:service}"],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Exec into Container",
      "type": "shell",
      "command": "npm",
      "args": ["run", "ecs:exec_container", "${input:service}"],
      "presentation": {
        "reveal": "always",
        "focus": true,
        "panel": "new",
        "showReuseMessage": false,
        "clear": false
      }
    },
    {
      "label": "Update Service",
      "type": "shell",
      "command": "./update-service.sh",
      "args": [
        "${input:service}",
        "task_definition_revision=${input:taskDefinitionRevision}"
      ],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Pull Env",
      "type": "shell",
      "command": "./pull-env.sh",
      "args": ["${input:service}"],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Push Env",
      "type": "shell",
      "command": "./push-env.sh",
      "args": ["${input:service}"],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "Test Integration",
      "type": "shell",
      "command": "./test.sh",
      "args": ["${input:service}", "${input:testCommand}"],
      "presentation": {
        "showReuseMessage": false
      }
    },
    {
      "label": "View Variables",
      "type": "shell",
      "command": "./view-variables.sh",
      "args": ["${input:service}"],
      "presentation": {
        "showReuseMessage": false
      }
    }
  ],
  "inputs": [
    {
      "id": "service",
      "type": "command",
      "command": "extension.commandvariable.file.pickFile",
      "args": {
        "description": "Which directory?",
        "include": "services/*/*",
        "transform": { "text": "${fileBasename}" },
        "showDirs": true,
        "keyRemember": "selectedService"
      }
    },
    {
      "id": "image",
      "type": "command",
      "command": "extension.commandvariable.file.pickFile",
      "args": {
        "description": "Which directory?",
        "include": "images/*/*",
        "transform": { "text": "${fileBasename}" },
        "showDirs": true,
        "keyRemember": "selectedImage"
      }
    },
    {
      "id": "testCommand",
      "type": "promptString",
      "default": "aws sts get-caller-identity",
      "description": "Command to execute"
    },
    {
      "id": "desiredCount",
      "type": "promptString",
      "default": "1",
      "description": "Desired task count in service"
    },
    {
      "id": "taskDefinitionRevision",
      "type": "promptString",
      "default": "",
      "description": "Task definition revision"
    }
  ]
}
